# 序·项目介绍

## 序

现代社会全球化的角逐场上，无视时空规则的网络往往能出奇制胜，当然，前提是，在不同国家不同地区之间网络能自由穿行，往来如风。而要使网络打破国门，呼吸不同国家的空气，迎面而来的第一座大山就是不同文化间语言的隔阂。而在本教程中，我们将初步学习如何打破语言的封闭性，迈出网络全球化的第一步。



## （一）网站国际化与本地化*

（一）网络国际化与本地化
每一个现代网站于设计之初，都应对国际化有所考虑。而在这个过程中，无论是网站本身主动的国际化，还是被动地被本地化，不同文化之间的语言的转化都是惊险的一步。
事实上，无论是结构复杂的软件还是相对简单的网站，实现网站语言并不需要对函数的源代码进行更改，只要对软件的显示内容翻译成目标语言即可。比如下面这个例子：

```html
<DOCTYPE html>
<HTML>
Hello world.    
</HTML>
```

> 通过这段代码，我们得到了一个英文短句"Hello world."为了得到中文的结果，我们可以用翻译软件将它翻译成中文。

```html
<DOCTYPE html>
<HTML>
你好 世界。
</HTML>
```

如上图所示，通过简单的字符串替换，我们就可以将英文内容翻译成适合中国人群阅读的汉语句子。

同理，在更加复杂的网站项目中，界面的国际化、本地化工作，本质上也是对显示字符串的替换。如果能够自动化提取、翻译、替换字符串，就能够大大减轻网络系统国际化的工作负担。

## （二）.po 文件

为了满足网络国际化的需求，软件工程师设计了以 .po 为后缀名的文件格式。

.po 是 Portable Object，即 **可移植对象文件格式** 的缩写。这是一种 **纯文本** 文件格式，可以直接用记事本等编辑器软件打开查看。文件中存储了从工程中提取的 **原始字符串**，以及相关信息（字符串类型，提取的位置等）。如果使用文本编辑器打开一个 .po 文件，其内容格式大致如下：

```po
"X-Poedit-SearchPath-0: ..\n"
"\n"
"X-Loco-Version: 2.2.2; wp-5.0.7"
##文本提取位置等信息

#: core/Notifications/Emails/Complete_Task_Notification.php:42
msgid "[%s] %s Task mark as %s in %s"
##输入内容一
msgstr ""
##输入内容一

#: core/Notifications/Emails/New_Comment_Notification.php:53 
#: core/Notifications/Emails/Update_Comment_Notification.php:52 
#: views/emails/html/new-message.php:39 views/emails/mention.php:13
msgid "Message"
##输入内容二
msgstr "消息"
##输出内容二
```

由于提取的字符串中包含了大量 **格式化字符、标记**，不能够简单进行整句翻译，.po 文件的翻译工作一般是手工完成的。但 .po 文件规模普遍较大（数千行甚至更多），翻译过程的自动化非常重要。

## （三）PIPE 模型与中间格式

（先对 **类 UNIX 系统的命令行操作** 做些了解，将有助于理解这部分内容）

### PIPE 模型

PIPE 即 **管道**，是一种进程间通信方式。顾名思义，管道联通两端。在计算机科学中，管道能够将一个进程的输出作为另一个进程的输入，从而使两个进程协同工作。管道可以通过操作系统提供的 IPC（进程间通信）功能实现，也可以通过连接标准输入输出流实现。具体到po.文件的翻译，就如下面这个流程：

![1572929512248](C:\Users\11580\AppData\Roaming\Typora\typora-user-images\1572929512248.png)

下面是一个两个进程协同工作的例子：

```python
# a.py
word = "hello world"
print(word)
```

```python
# b.py
import sys


def main():
    data = sys.argv[1:]
    if not sys.stdin.isatty():
        data.append(sys.stdin.read())
    return data


if __name__ == '__main__':
    data = main()
    print(' '.join(data))
  
```

使用 **管道操作符 `|`** 在类 UNIX 系统的命令行下调用这两个程序：

```bash
root@huang825172:~# python a.py | python b.py
hello world!
root@huang825172:~#
```

在这里，`a.py` 的输出通过管道输入到了 `b.py` 中，实现了两个进程间的通信。

PIPE 技术在实用工具中有着大量使用。借助于它，一个完整的工具可以由多个可执行文件组成，各自负责一个阶段的工作，并将处理结果传给下一个处理程序。在本项目中，这项技术用于将 **文本提取、处理** 和 **文本翻译** 隔离。隔离的好处在于，在使用过程中，每一个程序部分可以被 **灵活替换** 。同一个文本提取程序，配合不同语言、不同领域的翻译程序，可以输出适用不同场景的翻译版本。而同一个文本翻译程序，配合不同的文件提取器，可以翻译更多种类的文件。PIPE 技术大大提高了软件的 **可复用性**。

### 中间格式

在应用开发中，进程间交换的信息可能非常复杂，不能够像上一个例子使用字符串进行传输。为了更好地表示数据结构，往往需要设计一种数据格式用于交换信息。这种格式应该为进行通讯的双方进程所认可，拥有良好的 **结构和数据描述性**，并且足够 **易于解析**。

实际上，有数种符合上述要求的数据交换格式，已广泛应用于现代软件开发。中间格式的具体设计和实现，将会在后面的章节详细讲解。